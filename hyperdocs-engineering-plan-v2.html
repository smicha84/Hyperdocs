<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hyperdocs — Engineering Plan v2</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&family=JetBrains+Mono:wght@400;500;600&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --font-display: 'Instrument Serif', 'Georgia', serif;
    --font-body: 'DM Sans', system-ui, sans-serif;
    --font-mono: 'JetBrains Mono', 'SF Mono', Consolas, monospace;
    --bg: #faf9f7; --surface: #ffffff; --surface2: #f5f3f0; --surface3: #ede9e4;
    --border: rgba(0,0,0,0.06); --border-bright: rgba(0,0,0,0.12);
    --text: #1a1a1a; --text-dim: #6b6b6b;
    --accent: #2563eb; --accent-dim: rgba(37,99,235,0.06);
    --green: #16a34a; --green-dim: rgba(22,163,74,0.06);
    --amber: #d97706; --amber-dim: rgba(217,119,6,0.06);
    --red: #dc2626; --red-dim: rgba(220,38,38,0.06);
    --purple: #7c3aed; --purple-dim: rgba(124,58,237,0.06);
    --phaseA: #2563eb; --phaseB: #7c3aed; --phaseC: #16a34a;
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --bg: #111111; --surface: #1a1a1a; --surface2: #222222; --surface3: #2a2a2a;
      --border: rgba(255,255,255,0.06); --border-bright: rgba(255,255,255,0.12);
      --text: #e5e5e5; --text-dim: #888888;
      --accent: #60a5fa; --accent-dim: rgba(96,165,250,0.1);
      --green: #34d399; --green-dim: rgba(52,211,153,0.1);
      --amber: #fbbf24; --amber-dim: rgba(251,191,36,0.1);
      --red: #f87171; --red-dim: rgba(248,113,113,0.1);
      --purple: #a78bfa; --purple-dim: rgba(167,139,250,0.1);
      --phaseA: #60a5fa; --phaseB: #a78bfa; --phaseC: #34d399;
    }
  }
  * { margin:0; padding:0; box-sizing:border-box; min-width:0; }
  body { background:var(--bg); color:var(--text); font-family:var(--font-body); line-height:1.65; overflow-wrap:break-word; }

  .wrap { max-width:1340px; margin:0 auto; display:grid; grid-template-columns:180px 1fr; gap:0 40px; }
  .main { min-width:0; padding:40px 24px 80px; }

  /* TOC */
  .toc { position:sticky; top:0; height:100vh; padding:40px 0 40px 20px; display:flex; flex-direction:column; gap:2px; overflow-y:auto; }
  .toc::-webkit-scrollbar { width:3px; } .toc::-webkit-scrollbar-thumb { background:var(--surface3); border-radius:2px; }
  .toc-title { font-family:var(--font-mono); font-size:10px; text-transform:uppercase; letter-spacing:1.5px; color:var(--text-dim); margin-bottom:12px; }
  .toc a { font-size:13px; color:var(--text-dim); text-decoration:none; padding:5px 12px; border-left:2px solid transparent; transition:all 0.2s; display:block; }
  .toc a:hover { color:var(--text); border-left-color:var(--accent); background:var(--accent-dim); }
  .toc a.active { color:var(--accent); border-left-color:var(--accent); font-weight:600; }
  .toc .phase-label { font-family:var(--font-mono); font-size:10px; text-transform:uppercase; letter-spacing:1px; margin-top:12px; padding:3px 12px; }
  .toc .phase-label.a { color:var(--phaseA); } .toc .phase-label.b { color:var(--phaseB); } .toc .phase-label.c { color:var(--phaseC); }
  @media (max-width:900px) {
    .wrap { grid-template-columns:1fr; }
    .toc { position:sticky; top:0; z-index:100; height:auto; flex-direction:row; overflow-x:auto; padding:12px; background:var(--bg); border-bottom:1px solid var(--border); gap:4px; }
    .toc a { white-space:nowrap; border-left:none; border-bottom:2px solid transparent; padding:4px 10px; font-size:12px; }
    .toc a:hover,.toc a.active { border-left:none; border-bottom-color:var(--accent); }
    .toc .phase-label { margin-top:0; } .toc-title { display:none; }
  }

  /* Typography */
  h1 { font-family:var(--font-display); font-size:48px; font-weight:400; letter-spacing:-0.5px; line-height:1.1; margin-bottom:8px; }
  .subtitle { font-size:18px; color:var(--text-dim); margin-bottom:8px; }
  .meta { font-family:var(--font-mono); font-size:12px; color:var(--text-dim); margin-bottom:40px; display:flex; gap:16px; flex-wrap:wrap; }
  .meta span { background:var(--surface2); padding:3px 10px; border-radius:4px; }

  /* Section heads */
  .sec-head { font-family:var(--font-mono); font-size:12px; text-transform:uppercase; letter-spacing:1.5px; padding:10px 0; margin-top:48px; margin-bottom:20px; border-bottom:1px solid var(--border-bright); scroll-margin-top:20px; }
  .sec-head.a { color:var(--phaseA); border-bottom-color:var(--phaseA); }
  .sec-head.b { color:var(--phaseB); border-bottom-color:var(--phaseB); }
  .sec-head.c { color:var(--phaseC); border-bottom-color:var(--phaseC); }

  /* KPI */
  .kpi-row { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px; margin-bottom:32px; }
  .kpi { background:var(--surface); border:1px solid var(--border); border-radius:10px; padding:16px; text-align:center; }
  .kpi .num { font-family:var(--font-mono); font-size:28px; font-weight:700; }
  .kpi .lbl { font-size:11px; color:var(--text-dim); text-transform:uppercase; letter-spacing:0.5px; margin-top:2px; }

  /* Mermaid */
  .mermaid-wrap { background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:20px; position:relative; overflow:auto; margin-bottom:32px; scrollbar-width:thin; scrollbar-color:var(--border) transparent; }
  .mermaid-wrap::-webkit-scrollbar { width:6px; height:6px; }
  .mermaid-wrap::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
  .mermaid-wrap .mermaid { transition:transform 0.2s ease; transform-origin:top center; }
  .zoom-controls { position:absolute; top:10px; right:10px; display:flex; gap:2px; z-index:10; background:var(--surface); border:1px solid var(--border); border-radius:6px; padding:2px; }
  .zoom-controls button { width:28px; height:28px; border:none; background:transparent; color:var(--text-dim); font-family:var(--font-mono); font-size:14px; cursor:pointer; border-radius:4px; display:flex; align-items:center; justify-content:center; transition:background 0.15s, color 0.15s; }
  .zoom-controls button:hover { background:var(--border); color:var(--text); }
  .mermaid-wrap.is-zoomed { cursor:grab; } .mermaid-wrap.is-panning { cursor:grabbing; user-select:none; }

  /* Step card */
  .step { background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:24px; margin-bottom:20px; position:relative; overflow:hidden; }
  .step::before { content:''; position:absolute; top:0; left:0; right:0; height:2px; border-radius:12px 12px 0 0; }
  .step.a::before { background:var(--phaseA); } .step.b::before { background:var(--phaseB); } .step.c::before { background:var(--phaseC); }
  .step-header { display:flex; align-items:baseline; gap:12px; margin-bottom:12px; }
  .step-id { font-family:var(--font-mono); font-weight:700; font-size:14px; padding:3px 10px; border-radius:6px; flex-shrink:0; }
  .step.a .step-id { background:var(--accent-dim); color:var(--phaseA); }
  .step.b .step-id { background:var(--purple-dim); color:var(--phaseB); }
  .step.c .step-id { background:var(--green-dim); color:var(--phaseC); }
  .step h3 { font-size:18px; font-weight:600; }
  .step .desc { font-size:14px; color:var(--text-dim); margin-bottom:16px; }
  .step .detail-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
  @media (max-width:700px) { .step .detail-grid { grid-template-columns:1fr; } }
  .detail-box { background:var(--surface2); border-radius:8px; padding:14px 16px; }
  .detail-box h4 { font-family:var(--font-mono); font-size:11px; text-transform:uppercase; letter-spacing:0.5px; color:var(--text-dim); margin-bottom:8px; }
  .detail-box ul { list-style:none; font-size:13px; }
  .detail-box li { padding:2px 0; position:relative; padding-left:16px; }
  .detail-box li::before { content:''; position:absolute; left:0; top:10px; width:6px; height:6px; border-radius:50%; background:var(--border-bright); }

  /* Code block */
  .code-block { background:var(--surface2); border:1px solid var(--border); border-radius:8px; padding:14px 16px; font-family:var(--font-mono); font-size:12px; line-height:1.5; overflow-x:auto; white-space:pre; margin:12px 0; color:var(--text); }
  .code-block .comment { color:var(--text-dim); }
  .code-block .old { color:var(--red); text-decoration:line-through; opacity:0.7; }
  .code-block .new { color:var(--green); font-weight:500; }

  /* Tables */
  .table-wrap { overflow-x:auto; border:1px solid var(--border); border-radius:12px; background:var(--surface); margin-bottom:24px; }
  table { width:100%; border-collapse:collapse; font-size:13px; }
  thead th { background:var(--surface2); font-family:var(--font-mono); font-size:11px; text-transform:uppercase; letter-spacing:0.5px; color:var(--text-dim); padding:10px 14px; text-align:left; position:sticky; top:0; border-bottom:1px solid var(--border-bright); }
  tbody td { padding:8px 14px; border-bottom:1px solid var(--border); vertical-align:top; }
  tbody tr:hover { background:var(--accent-dim); }
  td code { font-family:var(--font-mono); font-size:11px; background:var(--surface2); padding:1px 5px; border-radius:3px; }
  .tag { font-size:11px; font-weight:600; padding:2px 8px; border-radius:4px; display:inline-block; white-space:nowrap; }
  .tag.touch { background:var(--accent-dim); color:var(--phaseA); }
  .tag.create { background:var(--green-dim); color:var(--green); }
  .tag.move { background:var(--purple-dim); color:var(--purple); }
  .tag.verify { background:var(--amber-dim); color:var(--amber); }

  /* Callout */
  .callout { background:var(--surface); border:1px solid var(--border); border-left:3px solid var(--accent); border-radius:8px; padding:14px 18px; margin-bottom:20px; font-size:14px; }
  .callout.warn { border-left-color:var(--amber); }
  .callout.decision { border-left-color:var(--purple); background:var(--purple-dim); }

  @keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeScale { from { opacity:0; transform:scale(0.95); } to { opacity:1; transform:scale(1); } }
  @media (prefers-reduced-motion: reduce) { * { animation:none !important; } }
</style>
</head>
<body>
<div class="wrap">

  <nav class="toc" id="toc">
    <div class="toc-title">Plan</div>
    <a href="#overview">Overview</a>
    <a href="#deps">Dependencies</a>
    <div class="phase-label a">Phase A</div>
    <a href="#a0">A0 Session Discovery</a>
    <a href="#a1">A1 Bundle V5</a>
    <a href="#a2">A2 Centralize Paths</a>
    <a href="#a3">A3 Requirements</a>
    <div class="phase-label b">Phase B</div>
    <a href="#b1">B1 Phase 1 Stubs</a>
    <a href="#b2">B2 Integration Test</a>
    <div class="phase-label c">Phase C</div>
    <a href="#c1">C1 Sync GitHub</a>
    <a href="#c2">C2 README</a>
    <a href="#manifest">File Manifest</a>
  </nav>

  <div class="main">

    <h1>Engineering Plan</h1>
    <p class="subtitle">Making Hyperdocs self-contained, portable, and production-ready</p>
    <div class="meta">
      <span>Feb 20, 2026</span>
      <span>8 steps, 3 phases</span>
      <span>github.com/smicha84/Hyperdocs</span>
    </div>

    <!-- OVERVIEW -->
    <div id="overview" class="sec-head">Overview</div>

    <div class="kpi-row">
      <div class="kpi"><div class="num" style="color:var(--phaseA)">4</div><div class="lbl">Phase A Steps</div></div>
      <div class="kpi"><div class="num" style="color:var(--phaseB)">2</div><div class="lbl">Phase B Steps</div></div>
      <div class="kpi"><div class="num" style="color:var(--phaseC)">2</div><div class="lbl">Phase C Steps</div></div>
      <div class="kpi"><div class="num" style="color:var(--phaseA)">10</div><div class="lbl">Files with Path Issues</div></div>
      <div class="kpi"><div class="num" style="color:var(--phaseB)">5</div><div class="lbl">V5 Files to Bundle</div></div>
    </div>

    <div class="callout">
      <strong>Goal:</strong> Any user with Claude Code + an Anthropic API key can clone the repo, run <code>pip install -r requirements.txt && python3 install.py</code>, and start processing their own sessions.
    </div>

    <!-- DEPENDENCY GRAPH -->
    <div id="deps" class="sec-head">Step Dependencies</div>

    <div class="mermaid-wrap">
      <div class="zoom-controls">
        <button onclick="zoomDiagram(this, 1.2)" title="Zoom in">+</button>
        <button onclick="zoomDiagram(this, 0.8)" title="Zoom out">&minus;</button>
        <button onclick="resetZoom(this)" title="Reset">&#8634;</button>
      </div>
      <pre class="mermaid">
flowchart LR
    subgraph A["Phase A — Self-Containment"]
        direction TB
        A0["A0: Session Discovery\n73 backup snapshots"]
        A1["A1: Bundle V5\n5 files into v5_compat/"]
        A2["A2: Centralize Paths\n9 files through config.py"]
        A3["A3: requirements.txt\n3 dependencies"]
    end
    subgraph B["Phase B — Completeness"]
        direction TB
        B1["B1: Phase 1 Stubs\nUser decides approach"]
        B2["B2: Integration Test\nFull pipeline, 1 session"]
    end
    subgraph C["Phase C — Ship"]
        direction TB
        C1["C1: Sync GitHub\nCommit + push"]
        C2["C2: README\nQuickstart guide"]
    end
    A0 --> B2
    A1 --> B2
    A2 --> B2
    A3 --> B2
    B1 --> B2
    B2 --> C1
    C1 --> C2
    classDef phA fill:#eff6ff,stroke:#2563eb,stroke-width:2px,color:#1e40af
    classDef phB fill:#f5f3ff,stroke:#7c3aed,stroke-width:2px,color:#5b21b6
    classDef phC fill:#ecfdf5,stroke:#16a34a,stroke-width:2px,color:#166534
    class A0,A1,A2,A3 phA
    class B1,B2 phB
    class C1,C2 phC
      </pre>
    </div>

    <div class="callout">
      <strong>Key insight:</strong> A0, A1, A2, A3, and B1 are all independent &mdash; they can run in parallel. B2 (integration test) depends on all of them. C1 and C2 are sequential and happen last.
    </div>

    <!-- PHASE A -->
    <div id="a0" class="sec-head a">Phase A &mdash; Self-Containment</div>

    <div class="step a">
      <div class="step-header">
        <span class="step-id">A0</span>
        <h3>Multi-Account Session Discovery</h3>
      </div>
      <div class="desc"><strong>NEW.</strong> Switching API accounts wipes <code>~/.claude/projects/</code>. 564 sessions are invisible to the current account. The backup system captured 73 snapshots (Jan 21 &ndash; Feb 17) preserving 210 unique sessions across accounts.</div>
      <div class="detail-grid">
        <div class="detail-box">
          <h4>Problem</h4>
          <ul>
            <li>3 API accounts on the same Mac</li>
            <li>Account switch = <code>~/.claude/projects/</code> wiped</li>
            <li>564 sessions only exist in Desktop backups</li>
            <li>73 backup snapshots (Jan 21 &ndash; Feb 17)</li>
          </ul>
        </div>
        <div class="detail-box">
          <h4>Solution</h4>
          <ul>
            <li><code>sync_to_permanent.py</code> reads from Desktop backups</li>
            <li>Consolidates all accounts into single canonical directory</li>
            <li>Deduplicates by session ID</li>
            <li>Output: <code>PERMANENT_CHAT_HISTORY/sessions/</code></li>
          </ul>
        </div>
      </div>
    </div>

    <div id="a1" class="step a">
      <div class="step-header">
        <span class="step-id">A1</span>
        <h3>Bundle V5 Dependencies</h3>
      </div>
      <div class="desc"><code>deterministic_prep.py</code> imports 5 modules from <code>hyperdocs_2/V5/code/</code> via <code>sys.path.insert()</code>. Other users won't have this directory.</div>
      <div class="detail-grid">
        <div class="detail-box">
          <h4>Files to Copy into v5_compat/</h4>
          <ul>
            <li><code>claude_session_reader.py</code> (13KB)</li>
            <li><code>claude_behavior_analyzer.py</code> (19KB)</li>
            <li><code>metadata_extractor.py</code> (40KB)</li>
            <li><code>message_filter.py</code> (8KB)</li>
            <li><code>geological_reader.py</code> (12KB)</li>
          </ul>
        </div>
        <div class="detail-box">
          <h4>What Changes</h4>
          <ul>
            <li>Create <code>phase_0_prep/v5_compat/__init__.py</code></li>
            <li>Copy 5 V5 files into <code>v5_compat/</code></li>
            <li>Update import in <code>deterministic_prep.py</code></li>
            <li>Test Phase 0 produces identical output</li>
          </ul>
        </div>
      </div>
      <div class="code-block"><span class="comment"># BEFORE (deterministic_prep.py line 30)</span>
<span class="old">V5_CODE = Path(__file__).parent / ".claude" / "hooks" / "hyperdoc" / "hyperdocs_2" / "V5" / "code"
sys.path.insert(0, str(V5_CODE))</span>

<span class="comment"># AFTER</span>
<span class="new">from phase_0_prep.v5_compat import (
    claude_session_reader, metadata_extractor,
    message_filter, claude_behavior_analyzer
)</span></div>
    </div>

    <div id="a2" class="step a">
      <div class="step-header">
        <span class="step-id">A2</span>
        <h3>Centralize PERMANENT_* Path References</h3>
      </div>
      <div class="desc">9 Python files hardcode <code>Path.home() / "PERMANENT_HYPERDOCS"</code> or <code>"PERMANENT_CHAT_HISTORY"</code> directly. These should all go through <code>config.py</code> with env var overrides.</div>
      <div class="detail-grid">
        <div class="detail-box">
          <h4>Files with Direct Path Refs (9)</h4>
          <ul>
            <li><code>phase1_redo_orchestrator.py</code> (4 refs)</li>
            <li><code>batch_phase0_reprocess.py</code> (3 refs)</li>
            <li><code>batch_llm_orchestrator.py</code> (2 refs)</li>
            <li><code>phase_0_prep/batch_llm_orchestrator.py</code> (3 refs)</li>
            <li><code>phase_0_prep/llm_pass_runner.py</code> (2 refs)</li>
            <li><code>phase_0_prep/merge_llm_results.py</code> (1 ref)</li>
            <li><code>phase_2_synthesis/code_similarity.py</code> (1 ref)</li>
            <li><code>phase_4_insertion/hyperdoc_layers.py</code> (1 ref)</li>
            <li><code>config.py</code> (add new vars)</li>
          </ul>
        </div>
        <div class="detail-box">
          <h4>New config.py Additions</h4>
          <ul>
            <li><code>STORE_DIR</code> &mdash; env: HYPERDOCS_STORE_DIR</li>
            <li><code>SESSIONS_DIR</code> = STORE_DIR / "sessions"</li>
            <li><code>INDEXES_DIR</code> = STORE_DIR / "indexes"</li>
            <li><code>HYPERDOCS_DIR</code> = STORE_DIR / "hyperdocs"</li>
            <li>All with <code>Path.home()</code> fallback</li>
          </ul>
        </div>
      </div>
      <div class="code-block"><span class="comment"># config.py additions</span>
<span class="new">STORE_DIR = Path(os.getenv("HYPERDOCS_STORE_DIR", str(Path.home() / "PERMANENT_HYPERDOCS")))
SESSIONS_DIR = STORE_DIR / "sessions"
INDEXES_DIR = STORE_DIR / "indexes"
HYPERDOCS_DIR = STORE_DIR / "hyperdocs"</span>

<span class="comment"># Then in each of the 9 files, replace:</span>
<span class="old">SESSIONS_DIR = Path.home() / "PERMANENT_HYPERDOCS" / "sessions"</span>
<span class="new">from config import SESSIONS_DIR</span></div>
    </div>

    <div id="a3" class="step a">
      <div class="step-header">
        <span class="step-id">A3</span>
        <h3>Create requirements.txt</h3>
      </div>
      <div class="desc">No dependency manifest exists. Users need to know what to install.</div>
      <div class="code-block"><span class="comment"># requirements.txt</span>
<span class="new">anthropic>=0.40.0
tiktoken>=0.5.0
python-dotenv>=1.0.0</span></div>
    </div>

    <!-- PHASE B -->
    <div id="b1" class="sec-head b">Phase B &mdash; Completeness</div>

    <div class="callout decision">
      <strong>Design Decision Required:</strong> The Phase 1 Python stubs (<code>extract_threads.py</code>, <code>tag_primitives.py</code>) exist as files but aren't functional. Two options:
    </div>

    <div class="step b">
      <div class="step-header">
        <span class="step-id">B1</span>
        <h3>Resolve Phase 1 Stub Files</h3>
      </div>
      <div class="desc">These files exist in <code>phase_1_extraction/</code> but don't do real work. Agent <code>.md</code> files and <code>phase1_redo_orchestrator.py</code> handle Phase 1.</div>
      <div class="detail-grid">
        <div class="detail-box" style="border-left:3px solid var(--phaseA);">
          <h4>Option A: Implement as Wrappers</h4>
          <ul>
            <li>Make them call orchestrator logic</li>
            <li>Enables: <code>python3 extract_threads.py SESSION_ID</code></li>
            <li>Pro: Users get a standalone entry point</li>
            <li>Con: Duplicates logic in the orchestrator</li>
          </ul>
        </div>
        <div class="detail-box" style="border-left:3px solid var(--phaseB);">
          <h4>Option B: Document and Clarify</h4>
          <ul>
            <li>Add docstrings explaining agents are the entry point</li>
            <li>Point to <code>phase1_redo_orchestrator.py</code></li>
            <li>Pro: No duplication, single source of truth</li>
            <li>Con: .py files appear broken to new users</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="b2" class="step b">
      <div class="step-header">
        <span class="step-id">B2</span>
        <h3>End-to-End Integration Test</h3>
      </div>
      <div class="desc">Run the full pipeline on a single fresh session. Proves the self-contained system works as a unit. Depends on A0 + A1 + A2 + A3 + B1 all being done.</div>
      <div class="detail-grid">
        <div class="detail-box">
          <h4>Test Sequence</h4>
          <ul>
            <li>1. Clone fresh from GitHub</li>
            <li>2. <code>pip install -r requirements.txt</code></li>
            <li>3. <code>python3 install.py</code></li>
            <li>4. <code>python3 concierge.py --discover</code></li>
            <li>5. <code>python3 concierge.py --process SESSION</code></li>
            <li>6. Verify <code>output/session_*/</code> has expected files</li>
          </ul>
        </div>
        <div class="detail-box">
          <h4>Expected Output Files</h4>
          <ul>
            <li><code>enriched_session.json</code> (Phase 0)</li>
            <li><code>session_summary.json</code> (Phase 0)</li>
            <li><code>safe_tier4.json</code> (Phase 0)</li>
            <li><code>tier4_priority_messages.json</code> (Phase 0)</li>
            <li><code>tier2plus_messages.json</code> (Phase 0)</li>
          </ul>
        </div>
      </div>
      <div class="callout warn" style="margin-top:16px">
        <strong>Note:</strong> Only Phase 0 tested in integration ($0, pure Python). Phases 1-5 require Opus API calls (cost money). Phase 0 proves self-containment; Phases 1-5 were verified on 261+ sessions already.
      </div>
    </div>

    <!-- PHASE C -->
    <div id="c1" class="sec-head c">Phase C &mdash; Ship</div>

    <div class="step c">
      <div class="step-header">
        <span class="step-id">C1</span>
        <h3>Sync and Push to GitHub</h3>
      </div>
      <div class="desc">After all changes verified, sync source to ~/Hyperdocs, commit, push. This becomes the new production baseline.</div>
      <div class="code-block"><span class="comment"># Commands</span>
bash ~/Hyperdocs/sync_from_dev.sh
<span class="comment"># Or manual: rsync + git add + git commit + git push</span></div>
    </div>

    <div id="c2" class="step c">
      <div class="step-header">
        <span class="step-id">C2</span>
        <h3>Update README with Quickstart</h3>
      </div>
      <div class="desc">Write a README.md that any user can follow: prerequisites, install, first run, architecture overview.</div>
      <div class="detail-grid">
        <div class="detail-box">
          <h4>README Sections</h4>
          <ul>
            <li>What is Hyperdocs (one paragraph)</li>
            <li>Prerequisites (Python 3.10+, API key)</li>
            <li>Installation (3 commands)</li>
            <li>First Run (discover + process)</li>
            <li>Architecture (6 phases, 1 sentence each)</li>
            <li>Configuration (env vars table)</li>
          </ul>
        </div>
        <div class="detail-box">
          <h4>What NOT to Include</h4>
          <ul>
            <li>Project history / session analysis</li>
            <li>Internal implementation details</li>
            <li>V5 migration story</li>
            <li>Gate system / constitution</li>
            <li>Anything user-specific</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- FILE MANIFEST -->
    <div id="manifest" class="sec-head">Complete File Manifest</div>

    <div class="table-wrap">
      <table>
        <thead><tr><th>File</th><th>Action</th><th>Step</th><th>What Happens</th></tr></thead>
        <tbody>
          <tr><td><code>sync_to_permanent.py</code></td><td><span class="tag create">CREATE/EDIT</span></td><td>A0</td><td>Multi-account session discovery from Desktop backups</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/__init__.py</code></td><td><span class="tag create">CREATE</span></td><td>A1</td><td>Package init for bundled V5 modules</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/claude_session_reader.py</code></td><td><span class="tag move">COPY</span></td><td>A1</td><td>From V5/code/ (13KB)</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/metadata_extractor.py</code></td><td><span class="tag move">COPY</span></td><td>A1</td><td>From V5/code/ (40KB)</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/message_filter.py</code></td><td><span class="tag move">COPY</span></td><td>A1</td><td>From V5/code/ (8KB)</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/claude_behavior_analyzer.py</code></td><td><span class="tag move">COPY</span></td><td>A1</td><td>From V5/code/ (19KB)</td></tr>
          <tr><td><code>phase_0_prep/v5_compat/geological_reader.py</code></td><td><span class="tag move">COPY</span></td><td>A1</td><td>From V5/code/ (12KB)</td></tr>
          <tr><td><code>phase_0_prep/deterministic_prep.py</code></td><td><span class="tag touch">EDIT</span></td><td>A1</td><td>Change V5 sys.path import to local v5_compat</td></tr>
          <tr><td><code>config.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Add STORE_DIR, SESSIONS_DIR, INDEXES_DIR, HYPERDOCS_DIR</td></tr>
          <tr><td><code>phase1_redo_orchestrator.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 4 direct PERMANENT_* refs</td></tr>
          <tr><td><code>batch_phase0_reprocess.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 3 direct PERMANENT_* refs</td></tr>
          <tr><td><code>batch_llm_orchestrator.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 2 direct PERMANENT_* refs</td></tr>
          <tr><td><code>phase_0_prep/batch_llm_orchestrator.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 3 direct PERMANENT_* refs</td></tr>
          <tr><td><code>phase_0_prep/llm_pass_runner.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 2 direct PERMANENT_* refs</td></tr>
          <tr><td><code>phase_0_prep/merge_llm_results.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 1 direct PERMANENT_* ref</td></tr>
          <tr><td><code>phase_2_synthesis/code_similarity.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 1 direct PERMANENT_* ref</td></tr>
          <tr><td><code>phase_4_insertion/hyperdoc_layers.py</code></td><td><span class="tag touch">EDIT</span></td><td>A2</td><td>Replace 1 direct PERMANENT_* ref</td></tr>
          <tr><td><code>requirements.txt</code></td><td><span class="tag create">CREATE</span></td><td>A3</td><td>anthropic, tiktoken, python-dotenv</td></tr>
          <tr><td><code>phase_1_extraction/extract_threads.py</code></td><td><span class="tag touch">EDIT</span></td><td>B1</td><td>User decides: implement or document</td></tr>
          <tr><td><code>phase_1_extraction/tag_primitives.py</code></td><td><span class="tag touch">EDIT</span></td><td>B1</td><td>User decides: implement or document</td></tr>
          <tr><td><code>README.md</code></td><td><span class="tag touch">EDIT</span></td><td>C2</td><td>Quickstart guide for new users</td></tr>
        </tbody>
      </table>
    </div>

    <div class="callout">
      <strong>Total scope:</strong> 8 new files created (6 in v5_compat + requirements.txt + sync_to_permanent.py), 13 existing files edited, 0 files deleted. Conservative, reversible changes.
    </div>

    <div style="text-align:center; margin-top:56px; color:var(--text-dim); font-size:12px; font-family:var(--font-mono);">
      Hyperdocs Engineering Plan v2 &bull; 8 steps, 3 phases &bull; Feb 20, 2026
    </div>

  </div>
</div>

<!-- Mermaid -->
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  mermaid.initialize({
    startOnLoad: true, theme: 'base', look: 'classic',
    flowchart: { useMaxWidth: true, htmlLabels: true, curve: 'basis' },
    themeVariables: {
      primaryColor: isDark ? '#1e293b' : '#eff6ff',
      primaryBorderColor: isDark ? '#60a5fa' : '#2563eb',
      primaryTextColor: isDark ? '#e5e5e5' : '#1a1a1a',
      lineColor: isDark ? '#444' : '#94a3b8',
      fontSize: '14px', fontFamily: "'DM Sans', system-ui, sans-serif",
    }
  });
</script>

<!-- Scroll spy -->
<script>
(function() {
  const toc = document.getElementById('toc');
  const links = toc.querySelectorAll('a');
  const sections = [];
  links.forEach(link => {
    const id = link.getAttribute('href').slice(1);
    const el = document.getElementById(id);
    if (el) sections.push({ id, el, link });
  });
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        links.forEach(l => l.classList.remove('active'));
        const match = sections.find(s => s.el === entry.target);
        if (match) {
          match.link.classList.add('active');
          if (window.innerWidth <= 900) match.link.scrollIntoView({ behavior:'smooth', block:'nearest', inline:'center' });
        }
      }
    });
  }, { rootMargin: '-10% 0px -80% 0px' });
  sections.forEach(s => observer.observe(s.el));
  links.forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      const id = link.getAttribute('href').slice(1);
      const el = document.getElementById(id);
      if (el) { el.scrollIntoView({ behavior:'smooth', block:'start' }); history.replaceState(null, '', '#' + id); }
    });
  });
})();
</script>

<!-- Zoom controls -->
<script>
function updateZoomState(wrap) {
  var target = wrap.querySelector('.mermaid');
  var zoom = parseFloat(target.dataset.zoom || '1');
  wrap.classList.toggle('is-zoomed', zoom > 1);
}
function zoomDiagram(btn, factor) {
  var wrap = btn.closest('.mermaid-wrap');
  var target = wrap.querySelector('.mermaid');
  var current = parseFloat(target.dataset.zoom || '1');
  var next = Math.min(Math.max(current * factor, 0.3), 5);
  target.dataset.zoom = next;
  target.style.transform = 'scale(' + next + ')';
  updateZoomState(wrap);
}
function resetZoom(btn) {
  var wrap = btn.closest('.mermaid-wrap');
  var target = wrap.querySelector('.mermaid');
  target.dataset.zoom = '1';
  target.style.transform = 'scale(1)';
  updateZoomState(wrap);
}
document.querySelectorAll('.mermaid-wrap').forEach(function(wrap) {
  wrap.addEventListener('wheel', function(e) {
    if (!e.ctrlKey && !e.metaKey) return;
    e.preventDefault();
    var target = wrap.querySelector('.mermaid');
    var current = parseFloat(target.dataset.zoom || '1');
    var factor = e.deltaY < 0 ? 1.1 : 0.9;
    var next = Math.min(Math.max(current * factor, 0.3), 5);
    target.dataset.zoom = next;
    target.style.transform = 'scale(' + next + ')';
    updateZoomState(wrap);
  }, { passive: false });
  var startX, startY, scrollL, scrollT;
  wrap.addEventListener('mousedown', function(e) {
    if (e.target.closest('.zoom-controls')) return;
    var target = wrap.querySelector('.mermaid');
    if (parseFloat(target.dataset.zoom || '1') <= 1) return;
    wrap.classList.add('is-panning');
    startX = e.clientX; startY = e.clientY;
    scrollL = wrap.scrollLeft; scrollT = wrap.scrollTop;
  });
  window.addEventListener('mousemove', function(e) {
    if (!wrap.classList.contains('is-panning')) return;
    wrap.scrollLeft = scrollL - (e.clientX - startX);
    wrap.scrollTop = scrollT - (e.clientY - startY);
  });
  window.addEventListener('mouseup', function() { wrap.classList.remove('is-panning'); });
});
</script>
</body>
</html>
